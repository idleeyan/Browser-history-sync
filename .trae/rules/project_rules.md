# 浏览器历史同步扩展 - 项目规则

## 版本管理规则

### 版本号格式
采用 [语义化版本控制 2.0.0](https://semver.org/lang/zh-CN/) 标准：

```
主版本号.次版本号.修订号
例如：1.2.3
```

- **主版本号**：重大功能更新、架构重构、不兼容的API修改
- **次版本号**：新增功能、模块添加、向下兼容的功能扩展
- **修订号**：问题修复、性能优化、文档更新

### 版本号更新触发条件

| 修改类型 | 版本更新 | 示例 |
|---------|---------|------|
| 修复bug、优化性能 | 修订号+1 | 1.2.3 → 1.2.4 |
| 新增功能、新增模块 | 次版本号+1，修订号归零 | 1.2.3 → 1.3.0 |
| 重大重构、不兼容变更 | 主版本号+1，其余归零 | 1.2.3 → 2.0.0 |

## 更新日志规则

### 更新日志位置
- 文件路径：`CHANGELOG.md`
- 位于项目根目录

### 更新日志格式

```markdown
# 更新日志

所有 notable 变更都会记录在此文件。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)。

## [未发布]

### 新增
- 暂无

### 变更
- 暂无

### 修复
- 暂无

## [1.2.3] - 2026-02-01

### 新增
- 新增功能X，支持...
- 新增模块Y，实现...

### 变更
- 优化了...性能
- 调整了...界面

### 修复
- 修复了...问题
- 解决了...bug

## [1.2.2] - 2026-01-28
...
```

### 更新日志分类

- **新增**：新功能、新模块、新接口
- **变更**：功能调整、性能优化、UI调整
- **修复**：bug修复、问题修复
- **移除**：删除功能、废弃接口
- **安全**：安全相关修复

## 强制规则

### ✅ 必须执行
1. **任何文件修改前**，先查看当前版本号（manifest.json 和 CHANGELOG.md）
2. **修改完成后**，根据修改类型更新版本号
3. **同步更新**以下文件的版本号：
   - `manifest.json` 中的 `"version"` 字段
   - `package.json` 中的 `"version"` 字段（如果存在）
   - `CHANGELOG.md` 中新增版本条目
4. **CHANGELOG.md 必须包含**：
   - 版本号
   - 发布日期（格式：YYYY-MM-DD）
   - 变更分类（新增/变更/修复等）
   - 简要描述（中文）

### ❌ 禁止行为
- 禁止不更新版本号直接提交修改
- 禁止不记录CHANGELOG直接提交修改
- 禁止版本号跳跃（如从1.2.1直接跳到1.2.5）

## 文件位置

```
项目根目录/
├── manifest.json          # 扩展版本号
├── package.json           # npm版本号
├── CHANGELOG.md           # 更新日志
└── .trae/
    └── rules/
        └── project_rules.md   # 本规则文件
```

## 快速检查清单

每次修改完成后，确认以下检查项：

- [ ] 已确定修改类型（修复/新增/重构）
- [ ] 已更新 manifest.json 中的版本号
- [ ] 已更新 package.json 中的版本号（如果存在）
- [ ] 已更新 CHANGELOG.md
- [ ] 变更描述清晰、简洁（中文）
- [ ] 日期格式正确（YYYY-MM-DD）

## 示例流程

### 示例：修复一个bug

1. **修改前**：当前版本 1.2.3
2. **修改代码**：修复 history-api.js 中的时间戳解析错误
3. **更新版本**：1.2.3 → 1.2.4（修订号+1）
4. **更新 manifest.json**：`"version": "1.2.4"`
5. **更新 CHANGELOG.md**：
   ```markdown
   ## [1.2.4] - 2026-02-01
   
   ### 修复
   - 修复 history-api.js 中时间戳解析错误的问题
   ```

### 示例：新增可视化功能

1. **修改前**：当前版本 1.2.3
2. **修改代码**：新增图表渲染模块
3. **更新版本**：1.2.3 → 1.3.0（次版本号+1，修订号归零）
4. **更新 manifest.json**：`"version": "1.3.0"`
5. **更新 CHANGELOG.md**：
   ```markdown
   ## [1.3.0] - 2026-02-01
   
   ### 新增
   - 新增浏览历史可视化报告功能
   - 支持柱状图、饼图展示访问统计
   - 新增报告页面（report.html）
   ```
